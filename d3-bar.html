<!DOCTYPE html>
<html>
  <head>

    <meta charset="utf-8"/>

    <style type="text/css">
    div.rainunits
    {
        display: inline-block;
        width: 20px;
        height: 75px;
        margin-right: 2px;
        background-color: teal;
    }
    </style>

    <script type="text/javascript" src="lib/jquery.min.js" charset="utf-8"></script>
    <script src="lib/d3.min.js" charset="utf-8"></script>

    <script type="text/javascript">

    var raindata = [];

        function showJson(data)
        {
            var yr, year, month;

            // Loop through all the years
            for (yr in data)
            {
                // Convert year to string, since key is a string
                year = yr.toString();

                // Loop through every month in the year
                for (month in data[year])
                {
                    raindata.push(data[year][month]);
                }
            }
        }

        function drawGraph(data)
        {
            //var raindata = [5, 10, 15, 20, 25, 22, 42];
            var w = 800, h = 300, barPadding = 1;
            var svg = d3.select("body")
                .append("svg")
                .attr("width", w)
                .attr("height", h);

            svg.selectAll("rect")
                .data(raindata)
                .enter()
                .append("rect")
                .attr("x", function(d, i) {
                    return (i * (w / raindata.length));
                })
                .attr("y", function (d) {
                    return (h - d)
                })
                .attr("width", w / raindata.length - barPadding)
                .attr("height", function (d) {
                    return d 
                })
                .attr("fill", function(d) {
                    return "rgb(0, 0, " + Math.round(d * 1.5) + ")";
                });

                /* If text should be displayed
                svg.selectAll("text")
                    .data(raindata)
                    .enter()
                    .append("text")
                    .text(function (d) {
                        return Math.round(d);
                    })
                    .attr("x", function (d, i) {
                        return (i * (w / raindata.length) + 2);
                    })
                    .attr("y", function (d, i) {
                        return h - (d + 1);
                    });
                */
        }

        function doThings()
        {
            $.getJSON("data/blr2000-02.json", showJson)
            .done(drawGraph)
            .fail(function() { console.error("getJSON Error!"); });
        }

    //@ sourceURL=j.html
    </script>

  </head>

  <body onload="doThings()">

    <script type="text/javascript">
    </script>


  </body>
</html>
